create table vega_mbsql_gen.TEMP0 as select a.analysis_id as analysis_id_1020,a.seq_region_start as seq_region_start_1020,a.canonical_annotation as canonical_annotation_1020,a.status as status_1020,a.canonical_transcript_id as canonical_transcript_id_1020,a.seq_region_end as seq_region_end_1020,a.seq_region_strand as seq_region_strand_1020,a.seq_region_id as seq_region_id_1020,a.gene_id as gene_id_1020_key,a.description as description_1020,a.source as source_1020,a.display_xref_id as display_xref_id_1020,a.biotype as biotype_1020,a.is_current as is_current_1020 from vega_mart_50.gene as a;
create index I_0 on vega_mbsql_gen.TEMP0(canonical_transcript_id_1020);
create table vega_mbsql_gen.TEMP2 as select a.*,b.stable_id as stable_id_1066_clash from vega_mbsql_gen.TEMP0 as a left join vega_mart_50.transcript_stable_id as b on a.canonical_transcript_id_1020=b.transcript_id;
drop table vega_mbsql_gen.TEMP0;
create index I_1 on vega_mbsql_gen.TEMP2(display_xref_id_1020);
create table vega_mbsql_gen.TEMP3 as select a.*,b.dbprimary_acc as dbprimary_acc_1074,b.display_label as display_label_1074,b.external_db_id as external_db_id_1074 from vega_mbsql_gen.TEMP2 as a left join vega_mart_50.xref as b on a.display_xref_id_1020=b.xref_id;
drop table vega_mbsql_gen.TEMP2;
create index I_2 on vega_mbsql_gen.TEMP3(external_db_id_1074);
create table vega_mbsql_gen.TEMP4 as select a.*,b.db_display_name as db_display_name_1018 from vega_mbsql_gen.TEMP3 as a left join vega_mart_50.external_db as b on a.external_db_id_1074=b.external_db_id;
drop table vega_mbsql_gen.TEMP3;
create index I_3 on vega_mbsql_gen.TEMP4(gene_id_1020_key);
create table vega_mbsql_gen.TEMP5 as select a.*,b.value as value_1022,b.attrib_type_id as attrib_type_id_1022 from vega_mbsql_gen.TEMP4 as a left join vega_mart_50.gene_attrib as b on a.gene_id_1020_key=b.gene_id and (b.attrib_type_id = 142);
drop table vega_mbsql_gen.TEMP4;
create index I_4 on vega_mbsql_gen.TEMP5(gene_id_1020_key);
create table vega_mbsql_gen.TEMP7 as select a.*,b.stable_id as stable_id_1023 from vega_mbsql_gen.TEMP5 as a left join vega_mart_50.gene_stable_id as b on a.gene_id_1020_key=b.gene_id;
drop table vega_mbsql_gen.TEMP5;
create index I_5 on vega_mbsql_gen.TEMP7(seq_region_id_1020);
create table vega_mbsql_gen.TEMP8 as select a.*,b.karyotype_id as karyotype_id_1027,b.band as band_1027 from vega_mbsql_gen.TEMP7 as a left join vega_mart_50.karyotype as b on a.seq_region_id_1020=b.seq_region_id and ((a.seq_region_start_1020>=b.seq_region_start and a.seq_region_start_1020<=b.seq_region_end and a.seq_region_strand_1020=1) or (a.seq_region_end_1020>=b.seq_region_start and a.seq_region_end_1020<=b.seq_region_end and a.seq_region_strand_1020=-1));
drop table vega_mbsql_gen.TEMP7;
create index I_6 on vega_mbsql_gen.TEMP8(seq_region_id_1020);
create table vega_mbsql_gen.TEMP9 as select a.*,b.coord_system_id as coord_system_id_1059,b.name as name_1059 from vega_mbsql_gen.TEMP8 as a left join vega_mart_50.seq_region as b on a.seq_region_id_1020=b.seq_region_id;
drop table vega_mbsql_gen.TEMP8;
alter table vega_mbsql_gen.TEMP9 drop column external_db_id_1074;
alter table vega_mbsql_gen.TEMP9 drop column dbprimary_acc_1074;
alter table vega_mbsql_gen.TEMP9 drop column karyotype_id_1027;
alter table vega_mbsql_gen.TEMP9 drop column attrib_type_id_1022;
alter table vega_mbsql_gen.TEMP9 drop column canonical_transcript_id_1020;
alter table vega_mbsql_gen.TEMP9 drop column coord_system_id_1059;
create index I_7 on vega_mbsql_gen.TEMP9(name_1059);
create index I_8 on vega_mbsql_gen.TEMP9(stable_id_1023);
create index I_9 on vega_mbsql_gen.TEMP9(biotype_1020);
rename table vega_mbsql_gen.TEMP9 to vega_mbsql_gen.gene_vega__gene__main;
create index I_10 on vega_mbsql_gen.gene_vega__gene__main(gene_id_1020_key);
create table vega_mbsql_gen.TEMP12 as select a.db_name as db_name_1018,a.db_display_name as db_display_name_1018,a.external_db_id as external_db_id_1018 from vega_mart_50.external_db as a;
create index I_11 on vega_mbsql_gen.TEMP12(external_db_id_1018);
create table vega_mbsql_gen.TEMP13 as select a.*,b.dbprimary_acc as dbprimary_acc_1074,b.display_label as display_label_1074,b.xref_id as xref_id_1074,b.description as description_1074 from vega_mbsql_gen.TEMP12 as a inner join vega_mart_50.xref as b on a.external_db_id_1018=b.external_db_id;
drop table vega_mbsql_gen.TEMP12;
create index I_12 on vega_mbsql_gen.TEMP13(xref_id_1074);
create table vega_mbsql_gen.TEMP14 as select a.*,b.ensembl_id as gene_id_1020_key,b.object_xref_id as object_xref_id_1040 from vega_mbsql_gen.TEMP13 as a inner join vega_mart_50.object_xref as b on a.xref_id_1074=b.xref_id;
drop table vega_mbsql_gen.TEMP13;
create index I_13 on vega_mbsql_gen.TEMP14(gene_id_1020_key);
create table vega_mbsql_gen.TEMP16 as select a.* from vega_mbsql_gen.TEMP14 as a inner join vega_mbsql_gen.gene_vega__gene__main as b on a.gene_id_1020_key=b.gene_id_1020_key;
drop table vega_mbsql_gen.TEMP14;
create index I_14 on vega_mbsql_gen.TEMP16(gene_id_1020_key);
create table vega_mbsql_gen.TEMP17 as select a.gene_id_1020_key,b.db_display_name_1018,b.dbprimary_acc_1074,b.description_1074,b.external_db_id_1018,b.xref_id_1074,b.object_xref_id_1040,b.db_name_1018,b.display_label_1074 from vega_mbsql_gen.gene_vega__gene__main as a left join vega_mbsql_gen.TEMP16 as b on a.gene_id_1020_key=b.gene_id_1020_key;
drop table vega_mbsql_gen.TEMP16;
alter table vega_mbsql_gen.TEMP17 drop column external_db_id_1018;
alter table vega_mbsql_gen.TEMP17 drop column xref_id_1074;
alter table vega_mbsql_gen.TEMP17 drop column object_xref_id_1040;
create index I_15 on vega_mbsql_gen.TEMP17(dbprimary_acc_1074);
rename table vega_mbsql_gen.TEMP17 to vega_mbsql_gen.gene_vega__ox__dm;
create index I_16 on vega_mbsql_gen.gene_vega__ox__dm(gene_id_1020_key);
alter table vega_mbsql_gen.gene_vega__gene__main add column (ox_bool integer default 0);
update vega_mbsql_gen.gene_vega__gene__main a set ox_bool=(select case count(1) when 0 then null else 1 end from vega_mbsql_gen.gene_vega__ox__dm b where a.gene_id_1020_key=b.gene_id_1020_key and not (b.db_display_name_1018 is null and b.dbprimary_acc_1074 is null and b.description_1074 is null and b.db_name_1018 is null and b.display_label_1074 is null));
create index I_17 on vega_mbsql_gen.gene_vega__gene__main(ox_bool);
create table vega_mbsql_gen.TEMP18 as select a.ox_bool,a.db_display_name_1018,a.analysis_id_1020,a.display_label_1074,a.seq_region_start_1020,a.description_1020,a.status_1020,a.seq_region_strand_1020,a.stable_id_1066_clash,a.display_xref_id_1020,a.seq_region_id_1020,a.is_current_1020,a.value_1022,a.stable_id_1023,a.biotype_1020,a.gene_id_1020_key,a.name_1059,a.canonical_annotation_1020,a.band_1027,a.seq_region_end_1020,a.source_1020 from vega_mbsql_gen.gene_vega__gene__main as a;
create index I_18 on vega_mbsql_gen.TEMP18(gene_id_1020_key);
create table vega_mbsql_gen.TEMP19 as select a.*,b.analysis_id as analysis_id_1064,b.seq_region_id as seq_region_id_1064,b.seq_region_start as seq_region_start_1064,b.description as description_1064,b.status as status_1064,b.display_xref_id as display_xref_id_1064,b.seq_region_end as seq_region_end_1064,b.biotype as biotype_1064,b.seq_region_strand as seq_region_strand_1064,b.transcript_id as transcript_id_1064_key,b.is_current as is_current_1064 from vega_mbsql_gen.TEMP18 as a left join vega_mart_50.transcript as b on a.gene_id_1020_key=b.gene_id;
drop table vega_mbsql_gen.TEMP18;
create index I_19 on vega_mbsql_gen.TEMP19(display_xref_id_1064);
create table vega_mbsql_gen.TEMP22 as select a.*,b.dbprimary_acc as dbprimary_acc_1074_r1,b.display_label as display_label_1074_r1,b.external_db_id as external_db_id_1074_r1 from vega_mbsql_gen.TEMP19 as a left join vega_mart_50.xref as b on a.display_xref_id_1064=b.xref_id;
drop table vega_mbsql_gen.TEMP19;
create index I_20 on vega_mbsql_gen.TEMP22(external_db_id_1074_r1);
create table vega_mbsql_gen.TEMP23 as select a.*,b.db_display_name as db_display_name_1018_r1 from vega_mbsql_gen.TEMP22 as a left join vega_mart_50.external_db as b on a.external_db_id_1074_r1=b.external_db_id;
drop table vega_mbsql_gen.TEMP22;
create index I_21 on vega_mbsql_gen.TEMP23(transcript_id_1064_key);
create table vega_mbsql_gen.TEMP24 as select a.*,b.stable_id as stable_id_1066 from vega_mbsql_gen.TEMP23 as a left join vega_mart_50.transcript_stable_id as b on a.transcript_id_1064_key=b.transcript_id;
drop table vega_mbsql_gen.TEMP23;
alter table vega_mbsql_gen.TEMP24 drop column external_db_id_1074_r1;
alter table vega_mbsql_gen.TEMP24 drop column dbprimary_acc_1074_r1;
create index I_22 on vega_mbsql_gen.TEMP24(biotype_1064);
create index I_23 on vega_mbsql_gen.TEMP24(biotype_1020);
create index I_24 on vega_mbsql_gen.TEMP24(name_1059);
create index I_25 on vega_mbsql_gen.TEMP24(stable_id_1066);
create index I_26 on vega_mbsql_gen.TEMP24(stable_id_1023);
rename table vega_mbsql_gen.TEMP24 to vega_mbsql_gen.gene_vega__transcript__main;
create index I_27 on vega_mbsql_gen.gene_vega__transcript__main(gene_id_1020_key);
create index I_28 on vega_mbsql_gen.gene_vega__transcript__main(transcript_id_1064_key);
alter table vega_mbsql_gen.gene_vega__gene__main add column (transcript_count integer default 0);
update vega_mbsql_gen.gene_vega__gene__main a set transcript_count=(select count(1) from vega_mbsql_gen.gene_vega__transcript__main b where a.gene_id_1020_key=b.gene_id_1020_key and not (b.db_display_name_1018_r1 is null and b.db_display_name_1018 is null and b.status_1064 is null and b.display_xref_id_1064 is null and b.biotype_1064 is null and b.biotype_1020 is null and b.name_1059 is null and b.seq_region_end_1020 is null and b.band_1027 is null and b.transcript_id_1064_key is null and b.seq_region_start_1020 is null and b.display_xref_id_1020 is null and b.value_1022 is null and b.seq_region_strand_1064 is null and b.is_current_1064 is null and b.stable_id_1066 is null and b.display_label_1074_r1 is null and b.source_1020 is null and b.display_label_1074 is null and b.analysis_id_1020 is null and b.status_1020 is null and b.description_1020 is null and b.seq_region_strand_1020 is null and b.analysis_id_1064 is null and b.seq_region_id_1020 is null and b.seq_region_id_1064 is null and b.seq_region_end_1064 is null and b.seq_region_start_1064 is null and b.stable_id_1066_clash is null and b.is_current_1020 is null and b.stable_id_1023 is null and b.description_1064 is null and b.canonical_annotation_1020 is null));
create index I_29 on vega_mbsql_gen.gene_vega__gene__main(transcript_count);
alter table vega_mbsql_gen.gene_vega__transcript__main add column (transcript_count integer default 0);
update vega_mbsql_gen.gene_vega__transcript__main a set transcript_count=(select max(transcript_count) from vega_mbsql_gen.gene_vega__gene__main b where a.gene_id_1020_key=b.gene_id_1020_key);
create index I_30 on vega_mbsql_gen.gene_vega__transcript__main(transcript_count);
create table vega_mbsql_gen.TEMP25 as select a.transcript_id_1064_key from vega_mbsql_gen.gene_vega__transcript__main as a;
create index I_31 on vega_mbsql_gen.TEMP25(transcript_id_1064_key);
create table vega_mbsql_gen.TEMP26 as select a.*,b.exon_id as exon_id_1017,b.rank as rank_1017 from vega_mbsql_gen.TEMP25 as a left join vega_mart_50.exon_transcript as b on a.transcript_id_1064_key=b.transcript_id;
drop table vega_mbsql_gen.TEMP25;
create index I_32 on vega_mbsql_gen.TEMP26(exon_id_1017);
create table vega_mbsql_gen.TEMP27 as select a.*,b.seq_region_id as seq_region_id_1015,b.seq_region_start as seq_region_start_1015,b.end_phase as end_phase_1015,b.phase as phase_1015,b.seq_region_end as seq_region_end_1015,b.seq_region_strand as seq_region_strand_1015,b.is_current as is_current_1015 from vega_mbsql_gen.TEMP26 as a left join vega_mart_50.exon as b on a.exon_id_1017=b.exon_id;
drop table vega_mbsql_gen.TEMP26;
create index I_33 on vega_mbsql_gen.TEMP27(exon_id_1017);
create table vega_mbsql_gen.TEMP28 as select a.*,b.modified_date as modified_date_1016,b.stable_id as stable_id_1016,b.created_date as created_date_1016,b.version as version_1016 from vega_mbsql_gen.TEMP27 as a left join vega_mart_50.exon_stable_id as b on a.exon_id_1017=b.exon_id;
drop table vega_mbsql_gen.TEMP27;
create index I_34 on vega_mbsql_gen.TEMP28(seq_region_id_1015);
create table vega_mbsql_gen.TEMP29 as select a.*,b.length as length_1059,b.coord_system_id as coord_system_id_1059,b.name as name_1059 from vega_mbsql_gen.TEMP28 as a left join vega_mart_50.seq_region as b on a.seq_region_id_1015=b.seq_region_id;
drop table vega_mbsql_gen.TEMP28;
create index I_35 on vega_mbsql_gen.TEMP29(seq_region_id_1015);
create table vega_mbsql_gen.TEMP31 as select a.*,b.value as value_1060,b.attrib_type_id as attrib_type_id_1060 from vega_mbsql_gen.TEMP29 as a left join vega_mart_50.seq_region_attrib as b on a.seq_region_id_1015=b.seq_region_id and (b.attrib_type_id=11 or b.attrib_type_id is null);
drop table vega_mbsql_gen.TEMP29;
create index I_36 on vega_mbsql_gen.TEMP31(attrib_type_id_1060);
create table vega_mbsql_gen.TEMP32 as select a.*,b.code as code_106,b.description as description_106,b.name as name_106 from vega_mbsql_gen.TEMP31 as a left join vega_mart_50.attrib_type as b on a.attrib_type_id_1060=b.attrib_type_id;
drop table vega_mbsql_gen.TEMP31;
alter table vega_mbsql_gen.TEMP32 drop column attrib_type_id_1060;
rename table vega_mbsql_gen.TEMP32 to vega_mbsql_gen.gene_vega__exon_transcript__dm;
create index I_37 on vega_mbsql_gen.gene_vega__exon_transcript__dm(transcript_id_1064_key);
alter table vega_mbsql_gen.gene_vega__transcript__main add column (exon_transcript_bool integer default 0);
update vega_mbsql_gen.gene_vega__transcript__main a set exon_transcript_bool=(select case count(1) when 0 then null else 1 end from vega_mbsql_gen.gene_vega__exon_transcript__dm b where a.transcript_id_1064_key=b.transcript_id_1064_key and not (b.is_current_1015 is null and b.code_106 is null and b.seq_region_end_1015 is null and b.description_106 is null and b.name_1059 is null and b.version_1016 is null and b.phase_1015 is null and b.name_106 is null and b.value_1060 is null and b.seq_region_id_1015 is null and b.exon_id_1017 is null and b.coord_system_id_1059 is null and b.length_1059 is null and b.end_phase_1015 is null and b.seq_region_strand_1015 is null and b.modified_date_1016 is null and b.created_date_1016 is null and b.seq_region_start_1015 is null and b.stable_id_1016 is null and b.rank_1017 is null));
create index I_38 on vega_mbsql_gen.gene_vega__transcript__main(exon_transcript_bool);
create table vega_mbsql_gen.TEMP33 as select a.db_name as db_name_1018,a.db_display_name as db_display_name_1018,a.external_db_id as external_db_id_1018 from vega_mart_50.external_db as a;
create index I_39 on vega_mbsql_gen.TEMP33(external_db_id_1018);
create table vega_mbsql_gen.TEMP34 as select a.*,b.dbprimary_acc as dbprimary_acc_1074,b.display_label as display_label_1074,b.xref_id as xref_id_1074,b.description as description_1074 from vega_mbsql_gen.TEMP33 as a inner join vega_mart_50.xref as b on a.external_db_id_1018=b.external_db_id;
drop table vega_mbsql_gen.TEMP33;
create index I_40 on vega_mbsql_gen.TEMP34(xref_id_1074);
create table vega_mbsql_gen.TEMP35 as select a.*,b.ensembl_id as transcript_id_1064_key,b.object_xref_id as object_xref_id_1040 from vega_mbsql_gen.TEMP34 as a inner join vega_mart_50.object_xref as b on a.xref_id_1074=b.xref_id;
drop table vega_mbsql_gen.TEMP34;
create index I_41 on vega_mbsql_gen.TEMP35(transcript_id_1064_key);
create table vega_mbsql_gen.TEMP37 as select a.* from vega_mbsql_gen.TEMP35 as a inner join vega_mbsql_gen.gene_vega__transcript__main as b on a.transcript_id_1064_key=b.transcript_id_1064_key;
drop table vega_mbsql_gen.TEMP35;
create index I_42 on vega_mbsql_gen.TEMP37(transcript_id_1064_key);
create table vega_mbsql_gen.TEMP38 as select a.transcript_id_1064_key,b.db_display_name_1018,b.dbprimary_acc_1074,b.description_1074,b.external_db_id_1018,b.xref_id_1074,b.object_xref_id_1040,b.db_name_1018,b.display_label_1074 from vega_mbsql_gen.gene_vega__transcript__main as a left join vega_mbsql_gen.TEMP37 as b on a.transcript_id_1064_key=b.transcript_id_1064_key;
drop table vega_mbsql_gen.TEMP37;
alter table vega_mbsql_gen.TEMP38 drop column external_db_id_1018;
alter table vega_mbsql_gen.TEMP38 drop column xref_id_1074;
alter table vega_mbsql_gen.TEMP38 drop column object_xref_id_1040;
create index I_43 on vega_mbsql_gen.TEMP38(dbprimary_acc_1074);
rename table vega_mbsql_gen.TEMP38 to vega_mbsql_gen.gene_vega__ox_mb001__dm;
create index I_44 on vega_mbsql_gen.gene_vega__ox_mb001__dm(transcript_id_1064_key);
alter table vega_mbsql_gen.gene_vega__transcript__main add column (ox_1_bool integer default 0);
update vega_mbsql_gen.gene_vega__transcript__main a set ox_1_bool=(select case count(1) when 0 then null else 1 end from vega_mbsql_gen.gene_vega__ox_mb001__dm b where a.transcript_id_1064_key=b.transcript_id_1064_key and not (b.db_display_name_1018 is null and b.dbprimary_acc_1074 is null and b.description_1074 is null and b.db_name_1018 is null and b.display_label_1074 is null));
create index I_45 on vega_mbsql_gen.gene_vega__transcript__main(ox_1_bool);
create table vega_mbsql_gen.TEMP39 as select a.display_label_1074_r1,a.ox_bool,a.db_display_name_1018,a.display_label_1074,a.analysis_id_1020,a.seq_region_strand_1064,a.status_1020,a.description_1020,a.seq_region_strand_1020,a.seq_region_end_1064,a.ox_1_bool,a.stable_id_1066,a.seq_region_id_1020,a.exon_transcript_bool,a.biotype_1020,a.seq_region_id_1064,a.gene_id_1020_key,a.name_1059,a.biotype_1064,a.db_display_name_1018_r1,a.seq_region_end_1020,a.band_1027,a.description_1064,a.seq_region_start_1020,a.transcript_count,a.stable_id_1066_clash,a.is_current_1020,a.display_xref_id_1020,a.seq_region_start_1064,a.value_1022,a.display_xref_id_1064,a.transcript_id_1064_key,a.stable_id_1023,a.is_current_1064,a.analysis_id_1064,a.canonical_annotation_1020,a.status_1064,a.source_1020 from vega_mbsql_gen.gene_vega__transcript__main as a;
create index I_46 on vega_mbsql_gen.TEMP39(transcript_id_1064_key);
create table vega_mbsql_gen.TEMP40 as select a.*,b.end_exon_id as end_exon_id_1068,b.translation_id as translation_id_1068_key,b.seq_end as seq_end_1068,b.start_exon_id as start_exon_id_1068,b.seq_start as seq_start_1068 from vega_mbsql_gen.TEMP39 as a inner join vega_mart_50.translation as b on a.transcript_id_1064_key=b.transcript_id;
drop table vega_mbsql_gen.TEMP39;
create index I_47 on vega_mbsql_gen.TEMP40(translation_id_1068_key);
create table vega_mbsql_gen.TEMP41 as select a.*,b.value as value_1069,b.attrib_type_id as attrib_type_id_1069 from vega_mbsql_gen.TEMP40 as a inner join vega_mart_50.translation_attrib as b on a.translation_id_1068_key=b.translation_id;
drop table vega_mbsql_gen.TEMP40;
create index I_48 on vega_mbsql_gen.TEMP41(attrib_type_id_1069);
create table vega_mbsql_gen.TEMP42 as select a.*,b.code as code_106,b.description as description_106,b.name as name_106 from vega_mbsql_gen.TEMP41 as a inner join vega_mart_50.attrib_type as b on a.attrib_type_id_1069=b.attrib_type_id;
drop table vega_mbsql_gen.TEMP41;
create index I_49 on vega_mbsql_gen.TEMP42(translation_id_1068_key);
create table vega_mbsql_gen.TEMP43 as select a.*,b.stable_id as stable_id_1070 from vega_mbsql_gen.TEMP42 as a inner join vega_mart_50.translation_stable_id as b on a.translation_id_1068_key=b.translation_id;
drop table vega_mbsql_gen.TEMP42;
create index I_50 on vega_mbsql_gen.TEMP43(transcript_id_1064_key);
create table vega_mbsql_gen.TEMP44 as select a.transcript_id_1064_key,b.display_label_1074_r1,b.db_display_name_1018,b.seq_region_end_1064,b.stable_id_1066,b.biotype_1020,b.gene_id_1020_key,b.name_1059,b.biotype_1064,b.band_1027,b.seq_region_end_1020,b.seq_region_start_1020,b.stable_id_1070,b.display_xref_id_1020,b.seq_region_start_1064,b.value_1022,b.display_xref_id_1064,b.analysis_id_1064,b.status_1064,b.end_exon_id_1068,b.source_1020,b.description_106,b.display_label_1074,b.analysis_id_1020,b.value_1069,b.start_exon_id_1068,b.seq_region_strand_1064,b.status_1020,b.description_1020,b.seq_region_strand_1020,b.seq_region_id_1020,b.name_106,b.seq_end_1068,b.translation_id_1068_key,b.seq_region_id_1064,b.db_display_name_1018_r1,b.attrib_type_id_1069,b.description_1064,b.seq_start_1068,b.code_106,b.stable_id_1066_clash,b.is_current_1020,b.stable_id_1023,b.is_current_1064,b.canonical_annotation_1020,b.ox_bool,b.exon_transcript_bool,b.transcript_count,b.ox_1_bool from vega_mbsql_gen.gene_vega__transcript__main as a left join vega_mbsql_gen.TEMP43 as b on a.transcript_id_1064_key=b.transcript_id_1064_key;
drop table vega_mbsql_gen.TEMP43;
create index I_51 on vega_mbsql_gen.TEMP44(stable_id_1066);
create index I_52 on vega_mbsql_gen.TEMP44(biotype_1020);
create index I_53 on vega_mbsql_gen.TEMP44(name_1059);
create index I_54 on vega_mbsql_gen.TEMP44(biotype_1064);
create index I_55 on vega_mbsql_gen.TEMP44(stable_id_1070);
create index I_56 on vega_mbsql_gen.TEMP44(stable_id_1023);
rename table vega_mbsql_gen.TEMP44 to vega_mbsql_gen.gene_vega__translation__main;
create index I_57 on vega_mbsql_gen.gene_vega__translation__main(transcript_id_1064_key);
create index I_58 on vega_mbsql_gen.gene_vega__translation__main(translation_id_1068_key);
alter table vega_mbsql_gen.gene_vega__transcript__main add column (translation_count integer default 0);
update vega_mbsql_gen.gene_vega__transcript__main a set translation_count=(select count(1) from vega_mbsql_gen.gene_vega__translation__main b where a.transcript_id_1064_key=b.transcript_id_1064_key and not (b.display_label_1074_r1 is null and b.db_display_name_1018 is null and b.seq_region_end_1064 is null and b.stable_id_1066 is null and b.biotype_1020 is null and b.gene_id_1020_key is null and b.name_1059 is null and b.biotype_1064 is null and b.band_1027 is null and b.seq_region_end_1020 is null and b.seq_region_start_1020 is null and b.stable_id_1070 is null and b.display_xref_id_1020 is null and b.seq_region_start_1064 is null and b.value_1022 is null and b.display_xref_id_1064 is null and b.analysis_id_1064 is null and b.status_1064 is null and b.end_exon_id_1068 is null and b.source_1020 is null and b.description_106 is null and b.display_label_1074 is null and b.analysis_id_1020 is null and b.value_1069 is null and b.start_exon_id_1068 is null and b.seq_region_strand_1064 is null and b.status_1020 is null and b.description_1020 is null and b.seq_region_strand_1020 is null and b.seq_region_id_1020 is null and b.name_106 is null and b.seq_end_1068 is null and b.translation_id_1068_key is null and b.seq_region_id_1064 is null and b.db_display_name_1018_r1 is null and b.attrib_type_id_1069 is null and b.description_1064 is null and b.seq_start_1068 is null and b.code_106 is null and b.stable_id_1066_clash is null and b.is_current_1020 is null and b.stable_id_1023 is null and b.is_current_1064 is null and b.canonical_annotation_1020 is null));
create index I_59 on vega_mbsql_gen.gene_vega__transcript__main(translation_count);
alter table vega_mbsql_gen.gene_vega__translation__main add column (translation_count integer default 0);
update vega_mbsql_gen.gene_vega__translation__main a set translation_count=(select max(translation_count) from vega_mbsql_gen.gene_vega__transcript__main b where a.transcript_id_1064_key=b.transcript_id_1064_key);
create index I_60 on vega_mbsql_gen.gene_vega__translation__main(translation_count);
create table vega_mbsql_gen.TEMP45 as select a.translation_id_1068_key from vega_mbsql_gen.gene_vega__translation__main as a;
create index I_61 on vega_mbsql_gen.TEMP45(translation_id_1068_key);
create table vega_mbsql_gen.TEMP46 as select a.*,b.external_data as external_data_1048,b.protein_feature_id as protein_feature_id_1048,b.analysis_id as analysis_id_1048,b.hit_name as hit_name_1048 from vega_mbsql_gen.TEMP45 as a inner join vega_mart_50.protein_feature as b on a.translation_id_1068_key=b.translation_id;
drop table vega_mbsql_gen.TEMP45;
create index I_62 on vega_mbsql_gen.TEMP46(hit_name_1048);
create table vega_mbsql_gen.TEMP48 as select a.*,b.interpro_ac as interpro_ac_1026 from vega_mbsql_gen.TEMP46 as a inner join vega_mart_50.interpro as b on a.hit_name_1048=b.id;
drop table vega_mbsql_gen.TEMP46;
create index I_63 on vega_mbsql_gen.TEMP48(interpro_ac_1026);
create table vega_mbsql_gen.TEMP49 as select a.*,b.display_label as display_label_1074,b.xref_id as xref_id_1074,b.description as description_1074,b.external_db_id as external_db_id_1074 from vega_mbsql_gen.TEMP48 as a inner join vega_mart_50.xref as b on a.interpro_ac_1026=b.dbprimary_acc;
drop table vega_mbsql_gen.TEMP48;
create index I_64 on vega_mbsql_gen.TEMP49(translation_id_1068_key);
create table vega_mbsql_gen.TEMP51 as select a.translation_id_1068_key,b.interpro_ac_1026,b.analysis_id_1048,b.protein_feature_id_1048,b.hit_name_1048,b.description_1074,b.xref_id_1074,b.external_db_id_1074,b.external_data_1048,b.display_label_1074 from vega_mbsql_gen.gene_vega__translation__main as a left join vega_mbsql_gen.TEMP49 as b on a.translation_id_1068_key=b.translation_id_1068_key;
drop table vega_mbsql_gen.TEMP49;
alter table vega_mbsql_gen.TEMP51 drop column analysis_id_1048;
alter table vega_mbsql_gen.TEMP51 drop column protein_feature_id_1048;
alter table vega_mbsql_gen.TEMP51 drop column xref_id_1074;
alter table vega_mbsql_gen.TEMP51 drop column external_db_id_1074;
create index I_65 on vega_mbsql_gen.TEMP51(interpro_ac_1026);
rename table vega_mbsql_gen.TEMP51 to vega_mbsql_gen.gene_vega__interpro__dm;
create index I_66 on vega_mbsql_gen.gene_vega__interpro__dm(translation_id_1068_key);
alter table vega_mbsql_gen.gene_vega__translation__main add column (interpro_bool integer default 0);
update vega_mbsql_gen.gene_vega__translation__main a set interpro_bool=(select case count(1) when 0 then null else 1 end from vega_mbsql_gen.gene_vega__interpro__dm b where a.translation_id_1068_key=b.translation_id_1068_key and not (b.interpro_ac_1026 is null and b.hit_name_1048 is null and b.description_1074 is null and b.external_data_1048 is null and b.display_label_1074 is null));
create index I_67 on vega_mbsql_gen.gene_vega__translation__main(interpro_bool);
create table vega_mbsql_gen.TEMP52 as select a.db_name as db_name_1018,a.db_display_name as db_display_name_1018,a.external_db_id as external_db_id_1018 from vega_mart_50.external_db as a;
create index I_68 on vega_mbsql_gen.TEMP52(external_db_id_1018);
create table vega_mbsql_gen.TEMP53 as select a.*,b.dbprimary_acc as dbprimary_acc_1074,b.display_label as display_label_1074,b.xref_id as xref_id_1074,b.description as description_1074 from vega_mbsql_gen.TEMP52 as a inner join vega_mart_50.xref as b on a.external_db_id_1018=b.external_db_id;
drop table vega_mbsql_gen.TEMP52;
create index I_69 on vega_mbsql_gen.TEMP53(xref_id_1074);
create table vega_mbsql_gen.TEMP54 as select a.*,b.ensembl_id as translation_id_1068_key,b.object_xref_id as object_xref_id_1040 from vega_mbsql_gen.TEMP53 as a inner join vega_mart_50.object_xref as b on a.xref_id_1074=b.xref_id;
drop table vega_mbsql_gen.TEMP53;
create index I_70 on vega_mbsql_gen.TEMP54(translation_id_1068_key);
create table vega_mbsql_gen.TEMP56 as select a.* from vega_mbsql_gen.TEMP54 as a inner join vega_mbsql_gen.gene_vega__translation__main as b on a.translation_id_1068_key=b.translation_id_1068_key;
drop table vega_mbsql_gen.TEMP54;
create index I_71 on vega_mbsql_gen.TEMP56(translation_id_1068_key);
create table vega_mbsql_gen.TEMP57 as select a.translation_id_1068_key,b.db_display_name_1018,b.dbprimary_acc_1074,b.description_1074,b.external_db_id_1018,b.xref_id_1074,b.object_xref_id_1040,b.db_name_1018,b.display_label_1074 from vega_mbsql_gen.gene_vega__translation__main as a left join vega_mbsql_gen.TEMP56 as b on a.translation_id_1068_key=b.translation_id_1068_key;
drop table vega_mbsql_gen.TEMP56;
alter table vega_mbsql_gen.TEMP57 drop column external_db_id_1018;
alter table vega_mbsql_gen.TEMP57 drop column xref_id_1074;
alter table vega_mbsql_gen.TEMP57 drop column object_xref_id_1040;
create index I_72 on vega_mbsql_gen.TEMP57(dbprimary_acc_1074);
rename table vega_mbsql_gen.TEMP57 to vega_mbsql_gen.gene_vega__ox_mb002__dm;
create index I_73 on vega_mbsql_gen.gene_vega__ox_mb002__dm(translation_id_1068_key);
alter table vega_mbsql_gen.gene_vega__translation__main add column (ox_2_bool integer default 0);
update vega_mbsql_gen.gene_vega__translation__main a set ox_2_bool=(select case count(1) when 0 then null else 1 end from vega_mbsql_gen.gene_vega__ox_mb002__dm b where a.translation_id_1068_key=b.translation_id_1068_key and not (b.db_display_name_1018 is null and b.dbprimary_acc_1074 is null and b.description_1074 is null and b.db_name_1018 is null and b.display_label_1074 is null));
create index I_74 on vega_mbsql_gen.gene_vega__translation__main(ox_2_bool);
create table vega_mbsql_gen.TEMP58 as select a.translation_id_1068_key from vega_mbsql_gen.gene_vega__translation__main as a;
create index I_75 on vega_mbsql_gen.TEMP58(translation_id_1068_key);
create table vega_mbsql_gen.TEMP59 as select a.*,b.external_data as external_data_1048,b.protein_feature_id as protein_feature_id_1048,b.analysis_id as analysis_id_1048,b.hit_end as hit_end_1048,b.score as score_1048,b.perc_ident as perc_ident_1048,b.seq_end as seq_end_1048,b.hit_start as hit_start_1048,b.seq_start as seq_start_1048,b.hit_name as hit_name_1048 from vega_mbsql_gen.TEMP58 as a inner join vega_mart_50.protein_feature as b on a.translation_id_1068_key=b.translation_id;
drop table vega_mbsql_gen.TEMP58;
create index I_76 on vega_mbsql_gen.TEMP59(analysis_id_1048);
create table vega_mbsql_gen.TEMP61 as select a.* from vega_mbsql_gen.TEMP59 as a inner join vega_mart_50.analysis as b on a.analysis_id_1048=b.analysis_id;
drop table vega_mbsql_gen.TEMP59;
create index I_77 on vega_mbsql_gen.TEMP61(translation_id_1068_key);
create table vega_mbsql_gen.TEMP62 as select a.translation_id_1068_key,b.perc_ident_1048,b.seq_start_1048,b.analysis_id_1048,b.protein_feature_id_1048,b.hit_end_1048,b.hit_name_1048,b.score_1048,b.hit_start_1048,b.external_data_1048,b.seq_end_1048 from vega_mbsql_gen.gene_vega__translation__main as a left join vega_mbsql_gen.TEMP61 as b on a.translation_id_1068_key=b.translation_id_1068_key;
drop table vega_mbsql_gen.TEMP61;
alter table vega_mbsql_gen.TEMP62 drop column analysis_id_1048;
alter table vega_mbsql_gen.TEMP62 drop column protein_feature_id_1048;
rename table vega_mbsql_gen.TEMP62 to vega_mbsql_gen.gene_vega__protein_feature__dm;
create index I_78 on vega_mbsql_gen.gene_vega__protein_feature__dm(translation_id_1068_key);
alter table vega_mbsql_gen.gene_vega__translation__main add column (protein_feature_bool integer default 0);
update vega_mbsql_gen.gene_vega__translation__main a set protein_feature_bool=(select case count(1) when 0 then null else 1 end from vega_mbsql_gen.gene_vega__protein_feature__dm b where a.translation_id_1068_key=b.translation_id_1068_key and not (b.perc_ident_1048 is null and b.seq_start_1048 is null and b.hit_end_1048 is null and b.hit_name_1048 is null and b.score_1048 is null and b.hit_start_1048 is null and b.external_data_1048 is null and b.seq_end_1048 is null));
create index I_79 on vega_mbsql_gen.gene_vega__translation__main(protein_feature_bool);
