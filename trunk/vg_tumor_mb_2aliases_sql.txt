create table vg_mb_sql_test.TEMP0 as select a.sex as sex_105,a.tumor_id as tumor_id_105,a.hospital_number as hospital_number_105,a.age as age_105,a.age_at_diagnosis as age_at_diagnosis_105,a.address as address_105,a.status as status_105,a.patient_name as patient_name_105,a.patient_id as patient_id_105_key,a.name as name_105 from vg_mbtest_tumor_oicr.patient as a;
create index I_0 on vg_mb_sql_test.TEMP0(tumor_id_105);
create table vg_mb_sql_test.TEMP1 as select a.*,b.prim as prim_1010,b.type as type_1010,b.tumor_name as tumor_name_1010 from vg_mb_sql_test.TEMP0 as a left join vg_mbtest_tumor_oicr.tumor as b on a.tumor_id_105=b.tumor_id and b.type="BREAST" a.hospital_number_105="123";
drop table vg_mb_sql_test.TEMP0;
rename table vg_mb_sql_test.TEMP1 to vg_mb_sql_test.patient__patient__main;
create index I_1 on vg_mb_sql_test.patient__patient__main(patient_id_105_key);
create table vg_mb_sql_test.TEMP2 as select a.patient_id_105_key from vg_mb_sql_test.patient__patient__main as a;
create index I_2 on vg_mb_sql_test.TEMP2(patient_id_105_key);
create table vg_mb_sql_test.TEMP3 as select a.*,b.epidemiology_id as epidemiology_id_102,b.epidemiology_name as epidemiology_name_102 from vg_mb_sql_test.TEMP2 as a inner join vg_mbtest_tumor_oicr.epidemiology as b on a.patient_id_105_key=b.patient_id;
drop table vg_mb_sql_test.TEMP2;
create index I_3 on vg_mb_sql_test.TEMP3(patient_id_105_key);
create table vg_mb_sql_test.TEMP4 as select a.patient_id_105_key,b.epidemiology_name_102,b.epidemiology_id_102 from vg_mb_sql_test.patient__patient__main as a left join vg_mb_sql_test.TEMP3 as b on a.patient_id_105_key=b.patient_id_105_key;
drop table vg_mb_sql_test.TEMP3;
rename table vg_mb_sql_test.TEMP4 to vg_mb_sql_test.patient__epidemiology__dm;
create index I_4 on vg_mb_sql_test.patient__epidemiology__dm(patient_id_105_key);
create table vg_mb_sql_test.TEMP5 as select a.patient_id_105_key from vg_mb_sql_test.patient__patient__main as a;
create index I_5 on vg_mb_sql_test.TEMP5(patient_id_105_key);
create table vg_mb_sql_test.TEMP6 as select a.*,b.site as site_107,b.sample_name as sample_name_107,b.sample_id as sample_id_107,b.date as date_107,b.procedure_name as procedure_name_107 from vg_mb_sql_test.TEMP5 as a inner join vg_mbtest_tumor_oicr.sample as b on a.patient_id_105_key=b.patient_id;
drop table vg_mb_sql_test.TEMP5;
create index I_6 on vg_mb_sql_test.TEMP6(patient_id_105_key);
create table vg_mb_sql_test.TEMP7 as select a.patient_id_105_key,b.procedure_name_107,b.site_107,b.sample_id_107,b.date_107,b.sample_name_107 from vg_mb_sql_test.patient__patient__main as a left join vg_mb_sql_test.TEMP6 as b on a.patient_id_105_key=b.patient_id_105_key;
drop table vg_mb_sql_test.TEMP6;
rename table vg_mb_sql_test.TEMP7 to vg_mb_sql_test.patient__sample__dm;
create index I_7 on vg_mb_sql_test.patient__sample__dm(patient_id_105_key);
create table vg_mb_sql_test.TEMP8 as select a.patient_id_105_key from vg_mb_sql_test.patient__patient__main as a;
create index I_8 on vg_mb_sql_test.TEMP8(patient_id_105_key);
create table vg_mb_sql_test.TEMP9 as select a.*,b.vaccinations as vaccinations_101,b.clinical_history_id as clinical_history_id_101,b.clinical_history_name as clinical_history_name_101,b.previous_treatment as previous_treatment_101,b.hospitalization as hospitalization_101 from vg_mb_sql_test.TEMP8 as a inner join vg_mbtest_tumor_oicr.clinical_history as b on a.patient_id_105_key=b.patient_id;
drop table vg_mb_sql_test.TEMP8;
create index I_9 on vg_mb_sql_test.TEMP9(patient_id_105_key);
create table vg_mb_sql_test.TEMP10 as select a.patient_id_105_key,b.previous_treatment_101,b.vaccinations_101,b.clinical_history_id_101,b.hospitalization_101,b.clinical_history_name_101 from vg_mb_sql_test.patient__patient__main as a left join vg_mb_sql_test.TEMP9 as b on a.patient_id_105_key=b.patient_id_105_key;
drop table vg_mb_sql_test.TEMP9;
rename table vg_mb_sql_test.TEMP10 to vg_mb_sql_test.patient__clinical_history__dm;
create index I_10 on vg_mb_sql_test.patient__clinical_history__dm(patient_id_105_key);
